<?php global $phpjiami_decrypt;$phpjiami_decrypt['ˆÖ¯¥ÖÀ¥ÁÖˆÖÖ®‹ÖÄ¾ˆ‹Ö‹ÃÃ®ı”¾®¾®']=base64_decode('Y291bnQ=');$phpjiami_decrypt['‹®®ÃÖÖ”¥Ã”ÖÃ¥ÄÖÀ¥””Ã”¥ÃÁÃ¾ÖˆÄÄı']=base64_decode('YXJyYXlfcmFuZA==');$phpjiami_decrypt['”‹¥Ö¯Ö‹ıÁ®ÖÀ®¾¾ÄÖˆ®Ä¯”ı¾‹¾ÄÃıÃ']=base64_decode('aW50dmFs'); ?>
<?php
class getjsonAction extends FrontAction {public function _initialize(){parent::_initialize();}public function getajax($val=0){$arr=array('result'=>$val);return json_encode($arr);}public function indexpro(){$indexpro=array();$rands=array();$random=array();$file='tody_tuijian';if(!S($file)){$today=get_contents($this->apiurl.'api/indexpro?id=1');$todayarr=json_decode($today,true);$tuijianlist=$todayarr['data'];S($file,$tuijianlist,15*60);}$tuijianlist=S($file);if($tuijianlist){if($GLOBALS['phpjiami_decrypt']['ˆÖ¯¥ÖÀ¥ÁÖˆÖÖ®‹ÖÄ¾ˆ‹Ö‹ÃÃ®ı”¾®¾®']($tuijianlist)<7){$rands=$tuijianlist;}else {$random=$GLOBALS['phpjiami_decrypt']['‹®®ÃÖÖ”¥Ã”ÖÃ¥ÄÖÀ¥””Ã”¥ÃÁÃ¾ÖˆÄÄı']($tuijianlist,6);if($random){foreach($random as $item){$rands[]=$tuijianlist[$item];}}}}if($rands){foreach($rands as $k=>$item){$id=$this->_idtohash($item['id']);$rands[$k]['id']=$id;$rands[$k]['price_youhuiquan']=$GLOBALS['phpjiami_decrypt']['”‹¥Ö¯Ö‹ıÁ®ÖÀ®¾¾ÄÖˆ®Ä¯”ı¾‹¾ÄÃıÃ']($item['price_youhuiquan']);$rands[$k]['url']=U('pro/show?id='.$id);$rands[$k]['thumb']=changepic($item['thumb'],'item');}}$indexpro['tody_tuijian']=$rands;$file='index_miaosha';if(!S($file)){$miao=get_contents($this->apiurl.'api/indexpro?id=2');$miaoarr=json_decode($miao,true);$miaosha=$miaoarr['data'];S($file,$miaosha,60*15);}$randlist=S($file);if($GLOBALS['phpjiami_decrypt']['ˆÖ¯¥ÖÀ¥ÁÖˆÖÖ®‹ÖÄ¾ˆ‹Ö‹ÃÃ®ı”¾®¾®']($randlist)<10){$index_miaosha=$randlist;}else {$random=$GLOBALS['phpjiami_decrypt']['‹®®ÃÖÖ”¥Ã”ÖÃ¥ÄÖÀ¥””Ã”¥ÃÁÃ¾ÖˆÄÄı']($randlist,9);foreach($random as $item){$index_miaosha[]=$randlist[$item];}}if($index_miaosha){foreach($index_miaosha as $k=> $item){$id=$this->_idtohash($item['id']);$index_miaosha[$k]['id']=$id;$index_miaosha[$k]['price_youhuiquan']=$GLOBALS['phpjiami_decrypt']['”‹¥Ö¯Ö‹ıÁ®ÖÀ®¾¾ÄÖˆ®Ä¯”ı¾‹¾ÄÃıÃ']($item['price_youhuiquan']);$index_miaosha[$k]['url']=U('pro/show?id='.$id);$index_miaosha[$k]['thumb']=changepic($item['thumb'],'item');}}$indexpro['index_miaosha']=$index_miaosha;$file='index_video_json';if(!S($file)){$videolist=get_contents($this->apiurl.'api/indexpro?id=4');$videolistarr=json_decode($videolist,true);$videolistdata=$videolistarr['data'];S($file,$videolistdata,15*60);}$videolist=S($file);if($videolist){if($GLOBALS['phpjiami_decrypt']['ˆÖ¯¥ÖÀ¥ÁÖˆÖÖ®‹ÖÄ¾ˆ‹Ö‹ÃÃ®ı”¾®¾®']($videolist)<5){$video=$videolist;}else {$videkey=$GLOBALS['phpjiami_decrypt']['‹®®ÃÖÖ”¥Ã”ÖÃ¥ÄÖÀ¥””Ã”¥ÃÁÃ¾ÖˆÄÄı']($videolist,4);if($videkey){foreach($videkey as $it){$video[]=$videolist[$it];}}}}if($video){foreach($video as $k=>$item){$id=$this->_idtohash($item['id']);$video[$k]['id']=$id;$video[$k]['price_youhuiquan']=$GLOBALS['phpjiami_decrypt']['”‹¥Ö¯Ö‹ıÁ®ÖÀ®¾¾ÄÖˆ®Ä¯”ı¾‹¾ÄÃıÃ']($item['price_youhuiquan']);$video[$k]['url']=U('pro/show?id='.$id);$video[$k]['thumb']=changepic($item['thumb'],'item');}}$indexpro['videolist']=$video;echo $this->getajax($indexpro);}public function indexlist(){$mixprice=0;$maxprice=0;$mixsales=0;$maxsales=0;$mixquan=0;$maxquan=0;$q='';if(C('ftx_index_mix_price')>0 && C('ftx_index_max_price')>0){$mixprice=C('ftx_index_mix_price');$maxprice=C('ftx_index_max_price');}else {if(C('ftx_index_mix_price')>0){$mixprice=C('ftx_index_mix_price');}if(C('ftx_index_max_price')>0){$maxprice=C('ftx_index_max_price');}}if(C('ftx_index_mix_volume')>0 && C('ftx_index_max_volume')>0){$mixsales=C('ftx_index_mix_volume');$maxsales=C('ftx_index_max_volume');}else {if(C('ftx_index_mix_volume')>0){$mixsales=C('ftx_index_mix_volume');}if(C('ftx_index_max_volume')>0){$maxsales=C('ftx_index_max_volume');}}if(C('ftx_index_mix_quan')>0 && C('ftx_index_max_quan')>0){$mixquan=C('ftx_index_mix_quan');$maxquan=C('ftx_index_max_quan');}else {if(C('ftx_index_mix_quan')>0){$mixquan=C('ftx_index_mix_quan');}if(C('ftx_index_max_quan')>0){$maxquan=C('ftx_index_max_quan');}}$indexnum=C('ftx_index_page_size');$file="index_pro_getjson";if(!S($file)){$q.='mixprice='.$mixprice.'&maxprice='.$maxprice.'&mixsales='.$mixsales.'&maxsales='.$maxsales.'&mixquan='.$mixquan.'&maxquan='.$maxquan;$data=get_contents($this->apiurl.'api/indexpro?id=3&per='.$indexnum.'&q='.$q);$dataarr=json_decode($data,true);$datalist=$dataarr['data'];S($file,$datalist,2*60);}$datalist=S($file);if($datalist){foreach($datalist as $k=>$item){$id=$this->_idtohash($item['id']);$datalist[$k]['id']=$id;$datalist[$k]['ids']=$item['id'];$datalist[$k]['price_youhuiquan']=$GLOBALS['phpjiami_decrypt']['”‹¥Ö¯Ö‹ıÁ®ÖÀ®¾¾ÄÖˆ®Ä¯”ı¾‹¾ÄÃıÃ']($item['price_youhuiquan']);$datalist[$k]['url']=U('pro/show?id='.$id);$datalist[$k]['thumb']=changepic($item['thumb'],'item');}}echo $this->getajax($datalist);}public function pronum(){$cate_id=0;$cate_id=$GLOBALS['phpjiami_decrypt']['”‹¥Ö¯Ö‹ıÁ®ÖÀ®¾¾ÄÖˆ®Ä¯”ı¾‹¾ÄÃıÃ'](I('get.cate_id'));$file="pro_count_".$cate_id;if(!S($file)){$pro_countj=get_contents($this->apiurl.'api/pronum?cate_id='.$cate_id);$pro_countj=json_decode($pro_countj,true);$pro_count=$pro_countj['message'];S($file,$pro_count,2*60);}$pro_count=S($file);echo $this->getajax($pro_count);}}?>