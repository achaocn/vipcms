<?php global $phpjiami_decrypt;$phpjiami_decrypt['¯ÀÖÖ¯”ÃÁ¯ÃÖˆ‹Ã¥”ÃÃı®¥®ÄÄ¯Ã¯¥Öˆ']=base64_decode('X2luaXRpYWxpemU=');$phpjiami_decrypt['”ÃÖ®ˆÁ¾À”®ˆÃÖ‹‹ÃÁ®ÃÃÃ”¾‹¾‹‹Á‹¾']=base64_decode('RA==');$phpjiami_decrypt['ıÁˆı”ÖıÃÖÃ‹Á®ˆÖÀ”¥¥‹”ÄÁ”¯¥Á¾¯Ã']=base64_decode('c3RydG90aW1l');$phpjiami_decrypt['ÁııÃ¯¥‹¯‹®”ıÃ®ÃÁÄ”ÀÖ‹Ã¯ÖÖı¥Ö‹']=base64_decode('dGltZQ==');$phpjiami_decrypt['¥Ã¾Ö”‹¯ÖÄÄˆÖÃÃÃÁ¥¥®Ö¥¯ÖÖÖ¯”Ö®¥']=base64_decode('bWV0aG9kX2V4aXN0cw==');$phpjiami_decrypt['¾”ıÁ®Ö®ÄÄ¯¾ı‹ÖÁˆÖÖÃÃÁ”¥”Ã¾ÄÄ”Á”']=base64_decode('ZGF0ZQ==');$phpjiami_decrypt['ÄÀÁ¾ÃˆÃ¥ÃˆÖÖÃÖÁ¯ÃÖÃÀÀÃÖÃˆ®ÖÁÖıÖ']=base64_decode('YXJyYXlfcG9w');$phpjiami_decrypt['”ÖÖÄ‹¾Ä¾¯ÃÖ¾ÖÁÖÃÀ‹ÀÃ”¾Ã®Ö””ˆÖÄ']=base64_decode('ZXhwbG9kZQ==');$phpjiami_decrypt['Áı®‹Á¾¯ÖÃÀÄÖÃ®ÖÃÃ®¾À¾Ã¾ÃÃÁˆ¾®Ã¥Ã']=base64_decode('c3RyX3JlcGxhY2U=');$phpjiami_decrypt['Ã®Ãˆ¯¥ÁˆÖ‹ıÃ‹ıÃÃ®Ã®¥¯¥ÖÖÄÃÃ”ÃÀÖ']=base64_decode('aXNfZmlsZQ==');$phpjiami_decrypt['Ã¯¾Ã®ı”ı¾ˆ‹¯Ö¾Ö”‹®ˆÁÃÀıÁ¯ˆÃ®']=base64_decode('dW5saW5r'); ?>
<?php
 class score_itemAction extends BackendAction {public function _initialize(){parent::$GLOBALS['phpjiami_decrypt']['¯ÀÖÖ¯”ÃÁ¯ÃÖˆ‹Ã¥”ÃÃı®¥®ÄÄ¯Ã¯¥Öˆ']();$this->_mod =D('score_item');$this->_cate_mod =D('score_item_cate');}public function _before_index(){$this->sort ='ordid';$this->order ='ASC';$_var_0 =$this->_cate_mod->field('id,name')->select();$_var_1 =array();foreach ($_var_0 as $_var_2){$_var_1[$_var_2['id']] =$_var_2['name'];}$this->assign('cate_list', $_var_1);}protected function _search(){$_var_3 =array();($_var_4 =$this->_request('cate_id', 'trim'))&& $_var_3['cate_id'] =array('eq', $_var_4);($_var_5 =$this->_request('keyword', 'trim'))&& $_var_3['title'] =array('like', '%' . $_var_5 . '%');$this->assign('search', array('keyword' => $_var_5, 'cate_id' => $_var_4,));return $_var_3;}public function add(){$_var_6 =$GLOBALS['phpjiami_decrypt']['”ÃÖ®ˆÁ¾À”®ˆÃÖ‹‹ÃÁ®ÃÃÃ”¾‹¾‹‹Á‹¾']($this->_name);if (IS_POST){if (false === $_var_7 =$_var_6->create()){IS_AJAX && $this->ajaxReturn(0, $_var_6->getError());$this->error($_var_6->getError());}$_var_7 =$this->_before_insert($_var_7);$_var_7['start_time'] =$GLOBALS['phpjiami_decrypt']['ıÁˆı”ÖıÃÖÃ‹Á®ˆÖÀ”¥¥‹”ÄÁ”¯¥Á¾¯Ã']($_var_7['start_time']);$_var_7['end_time'] =$GLOBALS['phpjiami_decrypt']['ıÁˆı”ÖıÃÖÃ‹Á®ˆÖÀ”¥¥‹”ÄÁ”¯¥Á¾¯Ã']($_var_7['end_time']);$_var_7['add_time'] =$GLOBALS['phpjiami_decrypt']['ÁııÃ¯¥‹¯‹®”ıÃ®ÃÁÄ”ÀÖ‹Ã¯ÖÖı¥Ö‹']();if ($_var_6->add($_var_7)){if ($GLOBALS['phpjiami_decrypt']['¥Ã¾Ö”‹¯ÖÄÄˆÖÃÃÃÁ¥¥®Ö¥¯ÖÖÖ¯”Ö®¥']($this, '_after_insert')){$_var_8 =$_var_6->getLastInsID();$this->_after_insert($_var_8);}IS_AJAX && $this->ajaxReturn(1, L('operation_success'), '', 'add');$this->success(L('operation_success'));}else {IS_AJAX && $this->ajaxReturn(0, L('operation_failure'));$this->error(L('operation_failure'));}}else {$this->assign('open_validator', true);if (IS_AJAX){$_var_9 =$this->fetch();$this->ajaxReturn(1, '', $_var_9);}else {$this->display();}}}public function edit(){$_var_6 =$GLOBALS['phpjiami_decrypt']['”ÃÖ®ˆÁ¾À”®ˆÃÖ‹‹ÃÁ®ÃÃÃ”¾‹¾‹‹Á‹¾']($this->_name);$_var_10 =$_var_6->getPk();if (IS_POST){if (false === $_var_7 =$_var_6->create()){IS_AJAX && $this->ajaxReturn(0, $_var_6->getError());$this->error($_var_6->getError());}$_var_7 =$this->_before_update($_var_7);$_var_7['start_time'] =$GLOBALS['phpjiami_decrypt']['ıÁˆı”ÖıÃÖÃ‹Á®ˆÖÀ”¥¥‹”ÄÁ”¯¥Á¾¯Ã']($_var_7['start_time']);$_var_7['end_time'] =$GLOBALS['phpjiami_decrypt']['ıÁˆı”ÖıÃÖÃ‹Á®ˆÖÀ”¥¥‹”ÄÁ”¯¥Á¾¯Ã']($_var_7['end_time']);if (false !== $_var_6->save($_var_7)){if ($GLOBALS['phpjiami_decrypt']['¥Ã¾Ö”‹¯ÖÄÄˆÖÃÃÃÁ¥¥®Ö¥¯ÖÖÖ¯”Ö®¥']($this, '_after_update')){$_var_8 =$_var_7['id'];$this->_after_update($_var_8);}IS_AJAX && $this->ajaxReturn(1, L('operation_success'), '', 'edit');$this->success(L('operation_success'));}else {IS_AJAX && $this->ajaxReturn(0, L('operation_failure'));$this->error(L('operation_failure'));}}else {$_var_8 =$this->_get($_var_10, 'intval');$_var_11 =$_var_6->find($_var_8);$this->assign('info', $_var_11);$this->assign('open_validator', true);if (IS_AJAX){$_var_9 =$this->fetch();$this->ajaxReturn(1, '', $_var_9);}else {$this->display();}}}public function _before_add(){$_var_1 =$this->_cate_mod->field('id,name')->select();$this->assign('cate_list', $_var_1);}public function _before_edit(){$this->_before_add();}protected function _before_insert($_var_7){if (!empty($_FILES['img']['name'])){$_var_12 =$GLOBALS['phpjiami_decrypt']['¾”ıÁ®Ö®ÄÄ¯¾ı‹ÖÁˆÖÖÃÃÁ”¥”Ã¾ÄÄ”Á”']('ym/d');$_var_13 =$this->_upload($_FILES['img'], 'score_item/' . $_var_12, array('width' => C('ftx_score_item_img.swidth'). ',' . C('ftx_score_item_img.bwidth'), 'height' => C('ftx_score_item_img.sheight'). ',' . C('ftx_score_item_img.bheight'), 'suffix' => '_s,_b', 'remove_origin' => true));if ($_var_13['error']){$this->error($_var_13['info']);}else {$_var_14 =$GLOBALS['phpjiami_decrypt']['ÄÀÁ¾ÃˆÃ¥ÃˆÖÖÃÖÁ¯ÃÖÃÀÀÃÖÃˆ®ÖÁÖıÖ']($GLOBALS['phpjiami_decrypt']['”ÖÖÄ‹¾Ä¾¯ÃÖ¾ÖÁÖÃÀ‹ÀÃ”¾Ã®Ö””ˆÖÄ']('.', $_var_13['info'][0]['savename']));$_var_7['img'] =$_var_12 . '/' . $GLOBALS['phpjiami_decrypt']['Áı®‹Á¾¯ÖÃÀÄÖÃ®ÖÃÃ®¾À¾Ã¾ÃÃÁˆ¾®Ã¥Ã']('.' . $_var_14, '_s.' . $_var_14, $_var_13['info'][0]['savename']);}}return $_var_7;}protected function _before_update($_var_7){if (!empty($_FILES['img']['name'])){$_var_12 =$GLOBALS['phpjiami_decrypt']['¾”ıÁ®Ö®ÄÄ¯¾ı‹ÖÁˆÖÖÃÃÁ”¥”Ã¾ÄÄ”Á”']('ym/d');$_var_15 =$this->_mod->where(array('id' => $_var_7['id']))->getField('img');$_var_15 ='score_item/' . $_var_12 . $_var_15;$GLOBALS['phpjiami_decrypt']['Ã®Ãˆ¯¥ÁˆÖ‹ıÃ‹ıÃÃ®Ã®¥¯¥ÖÖÄÃÃ”ÃÀÖ']($_var_15)&& @$GLOBALS['phpjiami_decrypt']['Ã¯¾Ã®ı”ı¾ˆ‹¯Ö¾Ö”‹®ˆÁÃÀıÁ¯ˆÃ®']($_var_15);$_var_13 =$this->_upload($_FILES['img'], 'score_item/' . $_var_12, array('width' => C('ftx_score_item_img.swidth'). ',' . C('ftx_score_item_img.bwidth'), 'height' => C('ftx_score_item_img.sheight'). ',' . C('ftx_score_item_img.bheight'), 'suffix' => '_s,_b', 'remove_origin' => true));if ($_var_13['error']){$this->error($_var_13['info']);}else {$_var_14 =$GLOBALS['phpjiami_decrypt']['ÄÀÁ¾ÃˆÃ¥ÃˆÖÖÃÖÁ¯ÃÖÃÀÀÃÖÃˆ®ÖÁÖıÖ']($GLOBALS['phpjiami_decrypt']['”ÖÖÄ‹¾Ä¾¯ÃÖ¾ÖÁÖÃÀ‹ÀÃ”¾Ã®Ö””ˆÖÄ']('.', $_var_13['info'][0]['savename']));$_var_7['img'] =$_var_12 . '/' . $GLOBALS['phpjiami_decrypt']['Áı®‹Á¾¯ÖÃÀÄÖÃ®ÖÃÃ®¾À¾Ã¾ÃÃÁˆ¾®Ã¥Ã']('.' . $_var_14, '_s.' . $_var_14, $_var_13['info'][0]['savename']);}}else {unset($_var_7['img']);}return $_var_7;}}