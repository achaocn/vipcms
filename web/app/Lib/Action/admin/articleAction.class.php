<?php global $phpjiami_decrypt;$phpjiami_decrypt['Ž¯ÀÖÖ¯”ÃÁ¯ÃÖˆ‹Ã¥Ž”ÃÃý®¥®ÄÄ¯Ã¯¥Öˆ']=base64_decode('X2luaXRpYWxpemU=');$phpjiami_decrypt['”ÃÖ®ˆÁ¾À”®ŽˆÃÖ‹‹ÃÁ®ÃÃÃ”¾‹¾Ž‹‹Á‹¾']=base64_decode('RA==');$phpjiami_decrypt['¾”ýÁ®Ö®ÄÄ¯Ž¾ý‹ÖÁˆÖÖÃÃÁ”¥”Ã¾ÄÄ”Á”']=base64_decode('ZGF0ZQ==');$phpjiami_decrypt['ÄÀÁ¾ÃˆÃ¥ÃˆÖŽÖÃÖÁ¯ÃÖÃÀÀÃÖÃˆ®ÖÁÖýÖ']=base64_decode('YXJyYXlfcG9w');$phpjiami_decrypt['”ÖÖÄ‹¾Ä¾¯ÃÖ¾ÖÁÖÃÀŽ‹ÀÃ”¾Ã®Ö””ˆÖÄŽ']=base64_decode('ZXhwbG9kZQ==');$phpjiami_decrypt['Áý®‹Á¾¯ÖÃÀÄÖÃ®ÖÃÃ®¾À¾Ã¾ÃÃÁˆ¾®Ã¥Ã']=base64_decode('c3RyX3JlcGxhY2U=');$phpjiami_decrypt['ÖÖÁÁˆŽ¯ÄŽÃÁ¾ŽÄ¯¾‹¥¥ÖÁ¯ÁÃÄÃˆŽ¯ÄÀÃ']=base64_decode('ZA==');$phpjiami_decrypt['ÃÁ¥ÃÖÄˆ®Ö¾¾‹¯ÄˆŽÖŽÖÁ”Ö¥¯¯Ä¾ÀˆÄŽˆ']=base64_decode('aW1wbG9kZQ=='); ?>
<?php
 class articleAction extends BackendAction {public function _initialize(){parent:: $GLOBALS['phpjiami_decrypt']['Ž¯ÀÖÖ¯”ÃÁ¯ÃÖˆ‹Ã¥Ž”ÃÃý®¥®ÄÄ¯Ã¯¥Öˆ']();$this->_mod =D('article');$this->_cate_mod =D('article_cate');}public function _before_index(){$sort =$this->_request("sort", 'trim', 'ordid');$_var_0 =$this->_request('order', 'trim', 'DESC');$_var_1 =$this->_cate_mod->order($sort . ' ' . $_var_0)->field('id,name')->select();$_var_2 =array();foreach ($_var_1 as $_var_3){$_var_2[$_var_3['id']] =$_var_3['name'];}$this->assign('cate_list', $_var_2);$_var_4 =$this->_get('p', 'intval', 1);$this->assign('p', $_var_4);}protected function _search(){$_var_5 =array();($_var_6 =$this->_request('time_start', 'trim'))&& $_var_5['add_time'][] =array('egt', strtotime($_var_6));($_var_7 =$this->_request('time_end', 'trim'))&& $_var_5['add_time'][] =array('elt', strtotime($_var_7)+ (24 * 60 * 60 - 1));($_var_8 =$this->_request('status', 'trim'))&& $_var_5['status'] =$_var_8;($_var_9 =$this->_request('keyword', 'trim'))&& $_var_5['title'] =array('like', '%' . $_var_9 . '%');$_var_10 =$this->_request('cate_id', 'intval');$_var_11 ='';if ($_var_10){$_var_12 =$this->_cate_mod->get_child_ids($_var_10, true);$_var_5['cate_id'] =array('IN', $_var_12);$_var_13 =$this->_cate_mod->where(array('id' => $_var_10))->getField('spid');$_var_11 =$_var_13 ? $_var_13 . $_var_10 : $_var_10;}$this->assign('search', array('time_start' => $_var_6, 'time_end' => $_var_7, 'cate_id' => $_var_10, 'selected_ids' => $_var_11, 'status' => $_var_8, 'keyword' => $_var_9,));return $_var_5;}public function _before_add(){$_var_14 =$_SESSION['pp_admin']['username'];$this->assign('author', $_var_14);$_var_15 =$GLOBALS['phpjiami_decrypt']['”ÃÖ®ˆÁ¾À”®ŽˆÃÖ‹‹ÃÁ®ÃÃÃ”¾‹¾Ž‹‹Á‹¾']('setting')->where(array('name' => 'site_name'))->getField('data');$this->assign('site_name', $_var_15);$_var_16 =$this->_cate_mod->field('id,name')->where(array('pid' => 0))->order('ordid DESC')->select();$this->assign('first_cate', $_var_16);}public function _before_edit(){$_var_17 =$this->_get('id', 'intval');$_var_18 =$this->_mod->field('id,cate_id')->where(array('id' => $_var_17))->find();$_var_13 =$this->_cate_mod->where(array('id' => $_var_18['cate_id']))->getField('spid');if ($_var_13 == 0){$_var_13 =$_var_18['cate_id'];}else {$_var_13 .= $_var_18['cate_id'];}$this->assign('selected_ids', $_var_13);}public function ajax_upload_img(){$_var_19 =$this->_get('type', 'trim', 'img');if (!empty($_FILES[$_var_19]['name'])){$dir =$GLOBALS['phpjiami_decrypt']['¾”ýÁ®Ö®ÄÄ¯Ž¾ý‹ÖÁˆÖÖÃÃÁ”¥”Ã¾ÄÄ”Á”']('ym/d/');$_var_20 =$this->_upload($_FILES['img'], 'article/' . $dir, array('width' => '280', 'height' => '280'));if ($_var_20['error']){$this->ajaxReturn(0, $_var_20['info']);}else {$_var_21 =$dir . $_var_20['info'][0]['savename'];$_var_22 =$GLOBALS['phpjiami_decrypt']['ÄÀÁ¾ÃˆÃ¥ÃˆÖŽÖÃÖÁ¯ÃÖÃÀÀÃÖÃˆ®ÖÁÖýÖ']($GLOBALS['phpjiami_decrypt']['”ÖÖÄ‹¾Ä¾¯ÃÖ¾ÖÁÖÃÀŽ‹ÀÃ”¾Ã®Ö””ˆÖÄŽ']('.', $_var_21));$_var_23['img'] =$GLOBALS['phpjiami_decrypt']['Áý®‹Á¾¯ÖÃÀÄÖÃ®ÖÃÃ®¾À¾Ã¾ÃÃÁˆ¾®Ã¥Ã']('.' . $_var_22, '_thumb.' . $_var_22, $_var_21);$this->ajaxReturn(1, L('operation_success'), $_var_23['img']);}}else {$this->ajaxReturn(0, L('illegal_parameters'));}}public function ajax_gettags(){$_var_24 =$this->_get("title", "trim");$_var_25 =$GLOBALS['phpjiami_decrypt']['ÖÖÁÁˆŽ¯ÄŽÃÁ¾ŽÄ¯¾‹¥¥ÖÁ¯ÁÃÄÃˆŽ¯ÄÀÃ']('items')->get_tags_by_title($_var_24);$_var_26 =$GLOBALS['phpjiami_decrypt']['ÃÁ¥ÃÖÄˆ®Ö¾¾‹¯ÄˆŽÖŽÖÁ”Ö¥¯¯Ä¾ÀˆÄŽˆ'](" ", $_var_25);$this->ajaxReturn(1, l('operation_success'), $_var_26);}}?>