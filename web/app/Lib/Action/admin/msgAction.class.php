<?php global $phpjiami_decrypt;$phpjiami_decrypt['¯ÀÖÖ¯”ÃÁ¯ÃÖˆ‹Ã¥”ÃÃı®¥®ÄÄ¯Ã¯¥Öˆ']=base64_decode('X2luaXRpYWxpemU=');$phpjiami_decrypt['ÃÖıÀˆı®‹¥ÖÀÄˆˆ”ÄÃ¥ı‹¥ıÀÖÄ‹ÀÖ¾ÖÁ']=base64_decode('TA==');$phpjiami_decrypt['¥ıÃÄ¥®ÃÃÀ¯®ıÀ¥Ä‹ÖÖˆ¾®ÁÃˆÄ¾Äˆ‹']=base64_decode('VQ==');$phpjiami_decrypt['ÖÄÃÃ”¥ı”‹¾ÄÄ¯ÖÖˆ¥¥Ö¥ˆˆÖ¾À¯¾¾Á']=base64_decode('c2Vzc2lvbg==');$phpjiami_decrypt['ˆˆ”ˆı®®Á¯ÀÃÄÁ¥¾ıÖÖ¯ˆ¯ÖˆÄ¾‹']=base64_decode('c3BsaXQ=');$phpjiami_decrypt['Ã¯Ã¯ÄıÁ‹Ãıı®ıˆÃÃ¾ÃÖÀÄ®ÃÄ”ÖÖÃ¥Àı']=base64_decode('TQ=='); ?>
<?php
 class msgAction extends BackendAction {public function _initialize(){parent::$GLOBALS['phpjiami_decrypt']['¯ÀÖÖ¯”ÃÁ¯ÃÖˆ‹Ã¥”ÃÃı®¥®ÄÄ¯Ã¯¥Öˆ']();$this->_mod =D('msg');}public function _before_index(){$_var_0 =$this->_get('type', 'intval', 1);if ($_var_0 == 1){$_var_1 =array('title' => $GLOBALS['phpjiami_decrypt']['ÃÖıÀˆı®‹¥ÖÀÄˆˆ”ÄÃ¥ı‹¥ıÀÖÄ‹ÀÖ¾ÖÁ']('å‘é€é€šçŸ¥'), 'iframe' => $GLOBALS['phpjiami_decrypt']['¥ıÃÄ¥®ÃÃÀ¯®ıÀ¥Ä‹ÖÖˆ¾®ÁÃˆÄ¾Äˆ‹']('msg/add'), 'id' => 'add', 'width' => '500', 'height' => '320');$this->assign('big_menu', $_var_1);}$this->assign('type', $_var_0);}protected function _search(){$_var_2 =array();($_var_3 =$this->_request('time_start', 'trim'))&& $_var_2['add_time'][] =array('egt', strtotime($_var_3));($_var_4 =$this->_request('time_end', 'trim'))&& $_var_2['add_time'][] =array('elt', strtotime($_var_4)+ (24 * 60 * 60 - 1));($_var_5 =$this->_request('keyword', 'trim'))&& $_var_2['info'] =array('like', '%' . $_var_5 . '%');($_var_6 =$this->_request('fname', 'trim'))&& $_var_2['fname'] =array('like', '%' . $_var_6 . '%');($_var_7 =$this->_request('tname', 'trim'))&& $_var_2['tname'] =array('like', '%' . $_var_7 . '%');$_var_0 =$this->_request('type', 'intval');if ($_var_0){if ($_var_0 == 1){$_var_2['fuid'] =0;}else if ($_var_0 == 2){$_var_2['fuid'] =array('gt', 0);}}$this->assign('search', array('time_start' => $_var_3, 'time_end' => $_var_4, 'fname' => $_var_6, 'tname' => $_var_7, 'type' => $_var_0, 'keyword' => $_var_5,));return $_var_2;}public function add(){if (IS_POST){$_var_8 =$this->_post('to_name', 'trim');$_var_9 =$GLOBALS['phpjiami_decrypt']['ÖÄÃÃ”¥ı”‹¾ÄÄ¯ÖÖˆ¥¥Ö¥ˆˆÖ¾À¯¾¾Á']('admin');$_var_10 =$_var_9['username'];$_var_11 =array(array('id' => '0', 'username' => 'SYSTEM'));if ($_var_8){$_var_8 =$GLOBALS['phpjiami_decrypt']['ˆˆ”ˆı®®Á¯ÀÃÄÁ¥¾ıÖÖ¯ˆ¯ÖˆÄ¾‹'](PHP_EOL, $_var_8);$_var_11 =$GLOBALS['phpjiami_decrypt']['Ã¯Ã¯ÄıÁ‹Ãıı®ıˆÃÃ¾ÃÖÀÄ®ÃÄ”ÖÖÃ¥Àı']('user')->field('id,username')->where(array('username' => array('in', $_var_8)))->select();}$_var_12 =$this->_post('info', 'trim');!$_var_12 && $this->ajaxReturn(0, L('message_empty'));foreach ($_var_11 as $_var_13){$this->_mod->create(array('fuid' => 0, 'fname' => 'SYSTEM', 'tuid' => $_var_13['id'], 'tname' => $_var_13['username'], 'info' => $_var_12, 'add_time' => time(),));$this->_mod->add();}$this->ajaxReturn(1, L('operation_success'), '', 'add');}else {$_var_14 =$this->fetch();$this->ajaxReturn(1, '', $_var_14);}}}